var AutoSuggest,__extends,Bing,sa_inst;(function(n){var t;(function(n){var f=function(){function n(){}return n.User="SRCHHPGUSR",n.History="_UR",n}(),t,i,r,u;n.CookieNames=f;t=function(){function n(){}return n.AutoSuggest="AS",n.History="OMW",n}();n.CrumbNames=t;i=function(){function n(){}return n.CursorPosition="cp",n.Options="o",n.ConversationId="cvid",n.SuggestionCount="sc",n.PartialQuery="pq",n.SuggestionPosition="sp",n.SuggestionType="qs",n.PreviewPaneSuggestionType="qsc",n.SkipValue="sk",n.PreviewPaneSkipValue="skc",n.Ghosting="ghc",n.Css="css",n.Count="count",n.DataSet="ds",n.SessionId="sid",n.TimeStamp="qt",n.Query="q",n.ImpressionGuid="ig",n.QFQuery="qry",n.FormCode="form",n.HashedMuid="nclid",n.RequestElToken="elvr",n.AppId="appid",n.History="history",n.ApiTextDecoration="textdecorations",n.ClientId="clientid",n.Market="mkt",n.Scope="scope",n.CountryCode="cc",n.HomeGeographicRegion="hgr",n}();n.QueryParams=i;r=function(){function n(){}return n.HistoryEnabled="hs",n.HitHighlighting="h",n.PopularNow="p",n.Local="l",n.Answers="a",n}();n.Options=r;u=function(){function n(){}return n.Id="id",n.Query="query",n.Url="url",n.Navigation="nav",n.Type="stype",n.Autocomplete="hc",n}();n.SuggestionAttributes=u})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(n){var t;(function(n){function t(n,t){if(n&&typeof t=="string"){var i="textContent";n[n[i]!==undefined?i:"innerText"]=t}}function i(n){return _w.getComputedStyle?_w.getComputedStyle(n,null):n.currentStyle}function r(n,t){var r=new RegExp("[?&]{1}"+t+"=([^&]+)"),i=n.match(r);return i?i[1]:null}function u(n,t,i){if(n.setSelectionRange)n.setSelectionRange(t,i);else{var r=n.createTextRange();r.moveEnd("sentence",-1e5);r.moveStart("character",t);r.moveEnd("character",i-t);r.select()}}function f(n,t){for(var r,i,u=0;i=t[u];++u)r=n.getAttribute(i),r&&(n[i]=r)}function e(n){var t=sj_ev(n);return{x:t.clientX,y:t.clientY}}function o(n,t){return function(i){var r=sj_ev(i),u=r.relatedTarget||(r.type=="mouseout"?r.toElement:r.fromElement);t===u||v(t,u)||n.call(t,r)}}function s(n,t){var i=0,r=_d.selection;if(n.selectionStart!=null)i=n.selectionStart;else if(r&&n.createTextRange){t&&n.focus();var u=n.createTextRange(),f=u.duplicate(),e=r.createRange();t&&u.moveToBookmark(e.getBookmark());f.setEndPoint("EndToStart",e);i=f.text.length}return i}function h(n,t){n&&(n.className=n.className.replace(t,""))}function c(n,t){var r,i;if(n){for(r=n.className.split(" "),i=0;i<r.length;i++)if(r[i]===t)return;n.className.length>0&&(n.className+=" ");n.className+=t}}function l(n,t){var i=t.replace(/\s+$/g,"");return t[t.length-1]==" "&&n.length>0&&a(t,i,n[0])?i:t}function a(n,t,i){return n==i.substr(0,n.length)||t==i}function v(n,t){if(n===t)return!1;while(t&&t!==n)t=t.parentNode;return t===n}n.SetInnerText=t;n.GetComputedStyle=i;n.GetQueryStringParam=r;n.SetSelectionRange=u;n.RewriteAttribsToProps=f;n.GetMouseCoords=e;n.MouseEnterLeave=o;n.getCursorPosition=s;n.RemoveClassName=h;n.AddClassName=c;n.TrimmedQueryFromSuggestions=l})(t=n.Utils||(n.Utils={}))})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function n(){this._eventRegistry=[]}return n.prototype.registerEvents=function(n){this._eventRegistry.push(n)},n.prototype.raiseEvent=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(i=0;i<this._eventRegistry.length;++i)this._eventRegistry[i].raise(n,r)},n.prototype.clearEvents=function(){this._eventRegistry=[]},n}();n.EventRegisterer=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function n(n){this._eventParent=n;this.events=[]}return n.prototype.add=function(n,t){this.events[n]=t},n.prototype.proxy=function(n){for(var i,u=this,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(i=0;i<r.length;++i)(function(t){u.events[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[+i]=arguments[i];r.splice(0,0,t);n.apply(u._eventParent,r)}})(r[i])},n.prototype.raise=function(n,t){var i=this.events[n];i&&i.apply(this._eventParent,t)},n}();n.EventRegistration=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t="_UR",i="OMW",r="_SS",u="SID",f=function(){function n(n){this._config=n;this._lastEnabledState=this.isHistoryEnabled()}return n.prototype.setDataProviderCallParams=function(n,t){this._sessionId||(this._sessionId=sj_cook.get(r,u));this.shouldFetchHistory(n)&&this._sessionId&&t.addParam(AutoSuggest.Service.QueryParams.Options,AutoSuggest.Service.Options.HistoryEnabled)},n.prototype.setQueryWithoutHistory=function(n,t){for(var i=0;i<t.length;i++)if(t[i].stype&&t[i].stype=="HS")return;this._lastQueryWithNoHistory=n},n.prototype.reset=function(){this._lastQueryWithNoHistory=null},n.prototype.isHistoryEnabled=function(){return this._config.eHS&&sj_cook.get(t,i)!="0"},n.prototype.shouldFetchHistory=function(n){var t=this.isHistoryEnabled();return(t!=this._lastEnabledState&&this.reset(),this._lastEnabledState=t,!t)?!1:this._lastQueryWithNoHistory?n.indexOf(this._lastQueryWithNoHistory)!=0:!0},n}();n.History=f})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(n){var t=AutoSuggest.Service.QueryParams,i="ajax.unload",r=[t.Ghosting],u=[t.PartialQuery,t.SuggestionCount,t.SuggestionPosition,t.SuggestionType,t.SkipValue,t.Ghosting,t.ConversationId,],f=function(f){function e(t,i,r){var s=this,o,h,u;for(f.call(this),this.config=t,this._container=i,this.currentQuery="",this.data={},this.ghostInstValue=0,this._cursorPosition=0,this._queryWithCurrentSuggestions="",this._receivedAtLeastOnceValidResponse=!1,this._isDisposed=!1,this.registerAjaxSerpUnloadEvent(),o=0;o<e.ScopeExtensions.length;++o)e.ScopeExtensions[o].init(this);e.ScopeExtensions=[];h=function(n,t,i,r){return s.dataProviderCallbackFunc(n,t,i,r)};this._dataProvider=new n.DataProvider(t,h);this._history=new n.History(t);this.canvas=new n.Canvas(this,t,i,r);u=new n.EventRegistration(this);u.add(10,function(n,t,i,r){s.raiseEvent(10,n,t,i,r);s._history.setQueryWithoutHistory(n,t)});u.proxy(this.raiseEvent,12,3,4,1,2,11,12);this.config.parqry&&u.add(13,function(n,t){this.raiseEvent(13,n,t)});this.canvas.registerEvents(u);this.raiseEvent(6,this)}return __extends(e,f),e.prototype.raiseUpdateGhostedText=function(n,t,i){this.raiseEvent(14,n,t,i)},e.prototype.raiseUpdateTextAndRequery=function(n,t){this.raiseEvent(13,n,t)},e.prototype.raiseUpdateText=function(n){this.raiseEvent(12,n)},e.prototype.raiseTextChanged=function(n,t){this.raiseEvent(18,n,t)},e.prototype.setData=function(n){this.data=n},e.prototype.dataProviderCallbackFunc=function(n,t,i,r){if(!this._isDisposed&&this.canvas.searchBoxHasFocus()){if(this.config.latencyLag>0&&!r){setTimeout(sj_wf(this.dataProviderCallbackFunc,n,t,i,!0),this.config.latencyLag);return}(this.raiseEvent(8),i==this.currentQuery)&&n!=null&&(this.raiseEvent(9,i,t),this._queryWithCurrentSuggestions=i,this.canvas.render(n,this.currentQuery,t),this._receivedAtLeastOnceValidResponse=!0)}},e.prototype.getAllSuggestionInstUrl=function(n,t){for(var f,r=this.getInstrumentationKeys(t),u=[],i=0;i<r.length;i++)f=this.getSuggestionInstValue(r[i],!0,n),f!==null&&(u=u.concat(["&",r[i],"=",f]));return u.join("")},e.prototype.getAllSuggestionInstObject=function(n,t){for(var u,r=this.getInstrumentationKeys(t),f={},i=0;i<r.length;i++)u=this.getSuggestionInstValue(r[i],!1,n),u!==null&&(f[r[i]]=u);return f},e.prototype.getInstrumentationKeys=function(n){return n?u:r},e.prototype.getSuggestionInstValue=function(n,i,r){r=r||this.canvas.selectedSuggestion;switch(n){case t.SuggestionCount:return this.canvas.currentSuggestionList.length+"-"+this._queryWithCurrentSuggestions.length;case t.PartialQuery:return i?encodeURIComponent(this.currentQuery):this.currentQuery;case t.SuggestionPosition:return r?(r.ord+1).toString():"-1";case t.SuggestionType:return r?r.src:"n";case t.SkipValue:return r&&r.sk?r.sk:"";case t.Ghosting:return this.ghostInstValue==0?null:this.ghostInstValue.toString();case t.ConversationId:return _G.IG;default:return null}},e.prototype.setCursorPosition=function(n){this._cursorPosition=n},e.prototype.fetch=function(i){var r,u,f;this.config.trimwswr&&i.length&&(r=n.Utils.TrimmedQueryFromSuggestions(this.canvas.currentSuggestionList,i),i!=r&&(this._dataProvider.addParam("trim","1"),this._cursorPosition--,this.currentQuery=i=r));this._dataProvider.addParam(t.CursorPosition,this._cursorPosition.toString());u=this._container.parentNode.offsetWidth.toString();this.config.cors?this._dataProvider.addParam("contentWidth",u):this._dataProvider.addHeader("X-Autosuggest-ContentWidth",u);this._history.setDataProviderCallParams(this.currentQuery,this._dataProvider);this._receivedAtLeastOnceValidResponse||this._dataProvider.addParam(t.Css,"1");f=this._dataProvider.fetch(i);this.raiseEvent(7,this.currentQuery,f)},e.prototype.registerAjaxSerpUnloadEvent=function(){var n=this,t=function(){n._isDisposed=!0;sj_evt.unbind(i,t);n.raiseEvent(17);n.clearEvents()};sj_evt.bind(i,t,!1)},e.prototype.setRawQuery=function(n){this.canvas.updateRawQuery(n)},e.prototype.setQuery=function(n){var t=this.config.eHS||this.config.ePN?0:1;n.length>=t&&(this.currentQuery=n,this.fetch(n))},e.ScopeExtensions=[],e}(n.EventRegisterer);n.WebCore=f})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=AutoSuggest.Service.QueryParams,i=function(){function n(n,t){this._config=n;this._callbackFunc=t;this._callParams={};this._callHeaders={};this._requestSequence=0}return n.prototype.getFinalUrl=function(n){for(var t in this._callParams)n+="&"+t+"="+this._callParams[t];return this._callParams={},n},n.prototype.addParam=function(n,t){this._callParams[n]=t},n.prototype.addHeader=function(n,t){if(this._config.cors)throw"Custom headers are not allowed for cross domain calls";this._callHeaders[n]=t},n.prototype.fetch=function(n){this.addParam(t.ConversationId,_G.IG);var i=this.getFinalUrl(decodeURIComponent(this._config.u)+encodeURIComponent(n));return this.fetchUrl(i,n)},n.prototype.fetchUrl=function(n,t){var f=this,i=sj_gx(),u=this._requestSequence++,r;i.open("GET",n,!0);for(r in this._callHeaders)i.setRequestHeader(r,this._callHeaders[r]);return this._callHeaders={},i.onreadystatechange=function(){if(i.readyState==4){i.onreadystatechange=function(){};var n;i.status==200&&(n=i.responseText);f._callbackFunc(n,u,t)}},i.withCredentials!==undefined&&(i.withCredentials=!0),i.send(),u},n}();n.DataProvider=i})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(n){var i="sa_hv",r=/(\s|^)sa_hv/g,u=n.Utils,t=AutoSuggest.Service.SuggestionAttributes,f=function(f){function e(t,i,r,u){f.call(this);this.autoSuggestInstance=t;this.config=i;this.container=r;this.currentSuggestionList=[];this._firstLastSuggestionId=[];this._ie9orLower=sb_ie&&!_w.atob;this._suggestionsContainer=r;this._searchBox=u;this._asContainer=_ge(i.c||"sw_as");var e=new n.EventRegistration(this);e.add(17,this.clearEvents);t.registerEvents(e)}return __extends(e,f),e.prototype.render=function(n,i,r){var h=0,o=[],s,e,f;if(this.container.innerHTML="",this._currentQuery=i,this.currentSuggestionList=[],this._currentSuggestion=null,this.selectedSuggestion=null,this._currentSelectedElement=null,this.insertAjaxResponseIntoDom(this.container,n),this._suggestionsContainer=_ge(this.config.slid),this._suggestionsContainer)for(s=this._suggestionsContainer.getElementsByTagName("li"),e=0;e<s.length;++e)if(f=s[e],f.parentNode.id==this.config.slid){if(f.className.indexOf("sa_hd")!=-1){f.hd=!0;continue}u.RewriteAttribsToProps(f,[t.Url,t.Query,t.Type,t.Autocomplete]);f.className.indexOf("pp_tile")!=-1&&(f.panel={ot:sb_gt()});this.currentSuggestionList.length==0&&(this._firstLastSuggestionId[2]=f.id);typeof f.url=="string"&&(f.addInst=f.url.indexOf("/search")==0);this.currentSuggestionList.push(f.query);this.decorateSuggestion(f,++h);this._firstLastSuggestionId[0]=f.id;o.push(f)}o.length>0?this.raiseEvent(10,i,o,r,this.container):this.raiseEvent(11,i)},e.prototype.updateRawQuery=function(n){this._rawQuery=n},e.prototype.mouseOverSuggestionHandler=function(t,r){var u=n.Utils.GetMouseCoords(t);this._previousMouseCoords=this._previousMouseCoords||u;this._previousMouseCoords&&(this._previousMouseCoords.x!=u.x||this._previousMouseCoords.y!=u.y)&&(this._previousMouseCoords=u,r.className.indexOf(i)==-1&&this.highlightSuggestion(r))},e.prototype.decorateSuggestion=function(t,i){var r=this,u;t.src=t.stype;t.ord=i;sj_be(t,"mousemove",function(n){return r.mouseOverSuggestionHandler(n,t)});sj_be(t,"mouseover",function(i){var u=n.Utils.MouseEnterLeave(function(n){return r.mouseOverSuggestionHandler(n,t)},t);u(i)});sj_be(t,"mousedown",function(n){return r.onMouseDownSuggestion(n,t)});sj_be(t,"mouseup",function(n){r.cancelEventBubbling(n);r.onMouseUpSuggestion(n,t)});u=window.navigator.msPointerEnabled?"onMSPointerDown":"ontouchstart";u.toLowerCase()in _w&&sj_be(t,u.substr(2),function(n){if(t.it="m",n.pointerType)switch(n.pointerType){case n.MSPOINTER_TYPE_TOUCH:t.it="t";break;case n.MSPOINTER_TYPE_PEN:t.it="p"}else t.it="t"})},e.prototype.handleArrowUpKey=function(){this.selectItem(0);this._currentSuggestion&&this.raiseEvent(1,this._currentSuggestion)},e.prototype.handleArrowDownKey=function(){this.selectItem(2);this._currentSuggestion&&this.raiseEvent(2,this._currentSuggestion)},e.prototype.getTargetElementId=function(n,i){if(!n)return this._firstLastSuggestionId[i];var r=n.getAttribute(t.Navigation);return r?r.split(";")[i]:null},e.prototype.selectItem=function(n){var i=this.getTargetElementId(this._currentSelectedElement,n),t;i&&(i==this.config.i?this.noItemSelected():(t=_ge(i),t&&(this.setSearchValue(t),this.highlightSuggestion(t))))},e.prototype.isClickOnElementWithClass=function(n,t){var i=event.target;return i&&i.className.indexOf(t)>-1},e.prototype.cancelEventBubbling=function(n){n=sj_ev(n);sj_sp(n)},e.prototype.highlightSuggestion=function(n){this.unHighlightSuggestionHandler();this._currentSuggestion=n;this.addHighlightClassName(this._currentSuggestion);this._currentSuggestion!=n&&this.addHighlightClassName(n);this._searchBox.setAttribute("aria-activedescendant",n.id);n.setAttribute("aria-selected","true");this._currentSelectedElement=n},e.prototype.unHighlightSuggestionHandler=function(){this._currentSelectedElement&&(this.removeHighlightClassName(this._currentSuggestion),this._currentSuggestion=null,this._currentSelectedElement.removeAttribute("aria-selected"),this.removeHighlightClassName(this._currentSelectedElement),this._currentSelectedElement=null)},e.prototype.noItemSelected=function(){this.setSearchValue();this.unHighlightSuggestionHandler();this._searchBox.removeAttribute("aria-activedescendant")},e.prototype.addHighlightClassName=function(n){r.test(n.className)||(n.className+=" "+i)},e.prototype.removeHighlightClassName=function(n){u.RemoveClassName(n,r)},e.prototype.onMouseDownSuggestion=function(n,t){n=sj_ev(n);var i=n.button;i==2?(this.cancelEventBubbling(n),sj_pd(n)):this.clickedSuggestion=t},e.prototype.onMouseUpSuggestion=function(n,t){this.clickedSuggestion&&this.clickedSuggestion==t&&(this.config.parqry&&this.isClickOnElementWithClass(n,"as_icon")?this.raiseEvent(13,t.query+" ",!1):(this.setSearchValue(this.clickedSuggestion),t.url?this.raiseEvent(4,t.url,t.addInst,t.query,!1,this.config.linkTarget):this.raiseEvent(3,t.query)),this.clickedSuggestion=null)},e.prototype.searchBoxHasFocus=function(){return _d.activeElement==this._searchBox},e.prototype.setSearchValue=function(n){this.selectedSuggestion=n;var t=this._currentQuery;(this.config.trimwsnr||this.config.trimwswr)&&this._rawQuery&&this._rawQuery[this._rawQuery.length-1]==" "&&(t=t+" ");this.raiseEvent(12,n?n.query:t)},e.prototype.getCssHolder=function(){var n=_ge("ajaxStyles");return n||(n=sj_ce("div"),n.id="ajaxStyles",sj_b.insertBefore(n,sj_b.firstChild)),n},e.prototype.insertScriptIntoDom=function(n){var r=this,t=sj_ce("script"),i;t.type=n.type;i=n.getAttribute("src");i?t.setAttribute("src",i):(t.setAttribute("data-bing-script","1"),t.text=n.innerHTML);n.parentNode.removeChild(n);this._asContainer.appendChild(t);sb_st(function(){return r._asContainer.removeChild(t)},1)},e.prototype.insertStyleIntoDom=function(n){this._ie9orLower?(sj_ic(n.innerHTML),n.parentNode.removeChild(n)):(n.setAttribute("data-rms","1"),this.getCssHolder().appendChild(n))},e.prototype.insertAjaxResponseIntoDom=function(n,t){var r,u,f,i;if(t){for(r=sj_ce("div"),r.innerHTML=t,u=_d.createDocumentFragment(),f=r.childNodes;f.length;){i=f[0];switch(i.tagName){case"SCRIPT":this.insertScriptIntoDom(i);break;case"STYLE":this.insertStyleIntoDom(i);break;default:u.appendChild(i)}}n.appendChild(u)}},e}(n.EventRegisterer);n.Canvas=f})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=function(){function t(t,i){this._config=t;this._container=i;this.isRtl=n.Utils.GetComputedStyle(sj_b).direction=="rtl";this.searchBoxElem=_ge(t.i);this._outerContainer=sj_ce("div","","sa_as");this._container.appendChild(this._outerContainer)}return t.prototype.getSuggestionsDrawer=function(){return this._outerContainer},t.prototype.show=function(){this._outerContainer.style.display="block"},t.prototype.hide=function(){this._outerContainer.style.display="none"},t.prototype.update=function(){var i,r,t=n.Utils.GetComputedStyle(this._container.parentNode);this.isRtl?(r=(this.toFloat(t.paddingRight)+this.toFloat(t.borderRightWidth))*-1,i=this.toFloat(t.borderLeftWidth)-this.toFloat(t.paddingLeft)):(i=(this.toFloat(t.paddingLeft)+this.toFloat(t.borderLeftWidth))*-1,r=this.toFloat(t.borderRightWidth)-this.toFloat(t.paddingRight));this._container.style.marginLeft=i+"px";this._container.style.marginRight=r+"px";this.searchBoxElem!=null&&this.searchBoxElem.dir.length>0&&(this._outerContainer.dir=this.searchBoxElem.dir)},t.prototype.toFloat=function(n){var t=parseFloat(n);return isNaN(t)?0:t},t}();n.Layout=t})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(n){function u(n){return typeof n=="number"?n:'"'+n.replace(/"/g,'\\"')+'"'}var t="SRCHHPGUSR",i="AS",f=4,r=sb_ie&&sb_de.style.opacity===undefined,e=function(e){function o(n){var i=this,t;for(e.call(this),this.config=n,this._pollInterval=0,this._pendingRequestCount=0,this._bRequeryOnTextChange=!0,this._hiddenFields=[],this._lastQuery="",this._lastRawQuery="",this._trimRegex=new RegExp("^\\s*","g"),this._removeSpacesRegex=new RegExp("\\s+","g"),this._lastTextChanged="",this._textChangeSequence=0,this._minChars=n.eHS||n.ePN?0:1,this.raiseEvent(5,n),_w.sa_si_T=function(n){return i._sa_si_T(n)},t=0;t<o.ScopeExtensions.length;++t)o.ScopeExtensions[t].init(this);o.ScopeExtensions=[]}return __extends(o,e),o.prototype.init=function(t){var e,r,u,f,o,h,i,s;(this.config.globalId=t,this.config.slid="sa_ul",this._bDisabled=this.isDisabled())||(_w._H&&_w._H.ajax?(e=_ge("serpHeader"),e&&(r=e.getElementsByTagName("form"),r&&r.length>0&&(this.searchForm=r[0],u=this.searchForm.getElementsByClassName("b_searchbox"),u&&u.length>0&&(this.searchBox=u[0])))):(this.searchForm=_ge(this.config.f),this.searchBox=_ge(this.config.i)),this.searchForm.form&&(this.config.fc=this.searchForm.form.value),f=_ge(this.config.c||"sw_as"),f.style.display="block",this.layout=this._layout=new n.Layout(this.config,f),this.layout.update(),this.registerUIElement(f),this.registerUIElement(this.searchBox),o=_ge("sb_form_go"),o&&this.registerUIElement(o),this._pollInterval=this.config.d,this._pollThrottlingEnabled=this.config.t,h=this._layout.getSuggestionsDrawer(),this.autosuggest=new n.WebCore(this.config,h,this.searchBox),this._lastQuery=this.getQueryToFetch(),this.searchBox.setAttribute("role","combobox"),this.searchBox.setAttribute("aria-autocomplete","both"),this.searchBox.setAttribute("aria-expanded","false"),this.searchBox.setAttribute("aria-owns",this.config.slid),i=new n.EventRegistration(this),i.add(8,this.handleResponseReceived),i.add(11,this.startNoMatchTimeout),i.add(10,this.showDropDown),i.add(12,this.onUpdateText),i.add(13,this.onUpdateTextAndRequery),i.add(14,this.onUpdateGhostedText),i.add(3,this.onNavigateSerp),i.add(4,this.onNavigateLink),i.add(17,this.dispose),this.autosuggest.registerEvents(i),s=new n.EventRegistration(this),s.proxy(this.raiseEvent,1,2),this.autosuggest.canvas.registerEvents(s),this.bindEvents(sj_be,sj_evt.bind),this.pollForQueryChange(),this.raiseEvent(6,this))},o.prototype.setData=function(n){this.autosuggest.setData(n)},o.prototype.isDisabled=function(){return sj_cook.get(t,i)=="0"},o.prototype.enable=function(n){n&&(this._lastQuery=this.getQueryToFetch());this._bDisabled=!n;sj_cook.set(t,i,n?"1":"0",!0,"/")},o.prototype.registerUIElement=function(n){sj_be(n,"touchend",sj_sp);sj_be(n,"click",sj_sp)},o.prototype.addHiddenField=function(n,t){var i=sj_ce("input");return i.id="sa_"+n,i.name=n,i.value=t,i.type="hidden",this.searchForm.appendChild(i),this.config.sbt&&this._hiddenFields.push(i),i},o.prototype.cancelDefaultHandler=function(n){sj_sp(n);sj_pd(n)},o.prototype.show=function(){this.onSearchBoxClick()},o.prototype.getCursorPosition=function(){return n.Utils.getCursorPosition(this.searchBox,!0)},o.prototype._sa_si_T=function(n){var t=_ge(n.replace("&","")),r,f,i,e;return t&&document.images&&(r=t.getAttribute("h"),i={a:[],add:function(n,t){this.a.push(u(n)+":"+u(t))},get:function(){return this.a.length?"&PR={"+this.a.join(",")+"}":""}},i.add("i",this.autosuggest.canvas.clickedSuggestion?t.it||"m":"k"),this.autosuggest.ghostInstValue&&i.add("ghc",this.autosuggest.ghostInstValue),t.panel&&i.add("et",sb_gt()-t.panel.ot),f=this.autosuggest.data&&this.autosuggest.data.Inst?this.autosuggest.data.Inst.IG:null,f&&r&&(e=new Image,e.src=_G.gpUrl+"IG="+f+"&"+r+i.get()),this.config.eUG&&this.makeSearchboxGPingCall()),!0},o.prototype.onNavigateSerp=function(n,t,i){var h,c,r,l,e,a,u,o,s,f;if(this.config.sbt){while(h=this._hiddenFields.shift())this.searchForm.removeChild(h);this._hiddenFields=[]}for(t&&this.raiseEvent(15),this._instrumentationData=this.autosuggest.getAllSuggestionInstObject(null,t),c=this.getCustomUrlParams(i),r=_ge("sa_ghc"),r&&r.parentNode.removeChild(r),l=0,a=[this._instrumentationData,c];e=a[l++];)for(u in e)r=_ge("sa_"+u),o=e[u],r?r.value=o:this.addHiddenField(u,o);this.autosuggest.ghostInstValue=0;t||sj_evt.fire("onSearch",this.searchForm);this.makeSearchboxGPingCall();this.fireEvt?(s=this.searchForm.getAttribute("action"),i&&this.searchForm.setAttribute("action",i),this.searchForm.submit(),this.firePartnerEvents(t),s&&this.searchForm.setAttribute("action",s)):_w._H&&_w._H.ajax&&_w.sj_isAjax&&t||this.searchForm.submit();this.fireEvt&&(this.autosuggest.canvas.selectedSuggestion=null,this.autosuggest.ghostInstValue=0,f=_ge("sa_ghc"),!this._instrumentationData.ghc&&f&&f.parentNode.removeChild(f))},o.prototype.makeSearchboxGPingCall=function(){var t,n;this._gpingDone&&this.config.eUG||(t=this.searchForm.getAttributeNode("onsubmit"),t&&_w.si_T&&(n=t.value.match(/si_T\('(.*)'\)/),n&&n[1]&&_w.si_T(n[1])),this._gpingDone=!0)},o.prototype.onNavigateLink=function(n,t,i,r,u){var e=this,f;if(sb_st(function(){return e.hideDropDown()},5),i!=undefined&&this.updateSearchBoxValue(i),this.config.sbt){this.onNavigateSerp(i,r,n);return}if(this.config.eUG)this.makeSearchboxGPingCall();else{if(this.searchForm.onsubmit)this.searchForm.onsubmit(null);this.firePartnerEvents(r)}f=n+(t?this.autosuggest.getAllSuggestionInstUrl():"");f=this.addExtraQueryStrings(f);u?_w.open(f,u):typeof sj_lc!="undefined"?sj_lc(f):_w.location=f},o.prototype.firePartnerEvents=function(n){!n&&this.fireEvt&&this.fireEvt(this.searchForm,"ASSugClicked")},o.prototype.getCustomUrlParams=function(n){var r={},t;if(n)for(var i,f=/\+/g,e=/([^&=]+)=?([^&]*)/g,u=function(n){return decodeURIComponent(n.replace(f," "))},o=n.substring(n.indexOf("?")+1);i=e.exec(o);)t=u(i[1]).toLowerCase(),t!=="q"&&t!=="form"&&(r[t]=u(i[2]));return r},o.prototype.bindEvents=function(n,t){var i=this;n(sj_b,"click",function(){return i.hideDropDownOnFocusChange()});n(sj_b,"touchend",function(){return i.hideDropDownOnFocusChange()});n(this.searchForm,"submit",function(n){return i.onSubmit(n)});n(this.searchBox,"keydown",function(n){return i.onSearchBoxKeyDown(n)});n(this.searchBox,"click",function(){return i.onSearchBoxClick()});this.fireEvt&&n(_w,"blur",function(){return i.hideDropDownOnFocusChange()});t("focusChange",function(n){return i.focusChange(n)});t("hideDrawer",function(){return i.hideDropDown()});"oninput"in this.searchBox&&n(this.searchBox,"input",function(){return i.onTextInput()})},o.prototype.onSubmit=function(n){var r=this,t,i;if(sb_st(function(){return r.hideDropDown()},5),this.cancelDefaultHandler(n),t=this.autosuggest.canvas.selectedSuggestion,t)if(_w.sa_si_T(t.getAttribute("id")),i=t.query,t.url)this.onNavigateLink(t.url,t.addInst,i,!0,this.config.linkTarget);else this.onNavigateSerp(i,!0);else this.onNavigateSerp(this.autosuggest.currentQuery,!0)},o.prototype.onSearchBoxKeyDown=function(n){this.handleUpDownEscKeys(n)},o.prototype.handleUpDownEscKeys=function(n){var t=n.keyCode;switch(t){case 27:this.isQueryGhosted()||(this.hideDropDown(),this.cancelDefaultHandler(n));break;case 38:this._isLayoutVisible&&(this.autosuggest.canvas.handleArrowUpKey(n),this.cancelDefaultHandler(n));break;case 40:this._isLayoutVisible?this.autosuggest.canvas.handleArrowDownKey(n):this.fetchForCurrentQuery();break;case 9:this.isQueryGhosted()||this.hideDropDownOnFocusChange()}},o.prototype.onSearchBoxClick=function(){this._isLayoutVisible||this.fetchForCurrentQuery()},o.prototype.fetchForCurrentQuery=function(){(this._noResultsTimeout&&sb_ct(this._noResultsTimeout),this._bDisabled)||(this._lastQuery=null,this.fetchSuggestions(this.getQueryToFetch(),this.getCurrentQuery(!0)))},o.prototype.showDropDown=function(){this._layout.update();this._isLayoutVisible||(sj_evt.fire("focusChange",this.searchBox),this._layout.show(),this._isLayoutVisible=!0,sb_i6&&sj_evt.fire("autosuggestShown",this.searchBox),sj_evt.fire("onPopTR"))},o.prototype.hideDropDownOnFocusChange=function(){this.hideDropDown()},o.prototype.hideDropDown=function(){this._isLayoutVisible&&(this._layout.hide(),this._isLayoutVisible=!1,this._lastQuery=this.getQueryToFetch(),this.raiseEvent(16),sb_i6&&sj_evt.fire("autosuggestHide",this.searchBox),_w._H&&sj_evt.fire("ASHide"))},o.prototype.focusChange=function(n){n[1]!==this.searchBox&&this.hideDropDown()},o.prototype.startNoMatchTimeout=function(){var n=this;this._noResultsTimeout=sb_st(function(){return n.hideDropDown()},50)},o.prototype.onUpdateText=function(n){this._bRequeryOnTextChange=!1;this.updateSearchBoxValue(n)},o.prototype.updateSearchBoxValue=function(t,i){var u=i?t+i:t,f;this._autoCompletedPrefixLength=i?t.length:null;u!==null&&(this.searchBox.value=u,r||this.searchBox.setAttribute("value",u),f=u.length,n.Utils.SetSelectionRange(this.searchBox,f,f),t&&t!=this._lastTextChanged&&this.triggerTextChangedEvent(t))},o.prototype.onUpdateTextAndRequery=function(t,i){if(this._bRequeryOnTextChange=!0,this.updateSearchBoxValue(t),!i){var r=t.length;this.searchBox.focus();n.Utils.SetSelectionRange(this.searchBox,r,r)}},o.prototype.onUpdateGhostedText=function(n,t,i){this._bRequeryOnTextChange=i===undefined?!0:i;this.updateSearchBoxValue(n,t)},o.prototype.onTextInput=function(){var n=this.searchBox.value;this.triggerTextChangedEvent(n)},o.prototype.triggerTextChangedEvent=function(n){this._lastTextChanged=n;this.autosuggest.raiseTextChanged(n,++this._textChangeSequence)},o.prototype.pollForQueryChange=function(){var u=this,t,n,i;this._bDisabled||(t=this.getCurrentQuery(),this._lastRawQuery!=t&&(this.autosuggest.setRawQuery(t),this._lastRawQuery=t,n=this.getQueryToFetch(),this._lastQuery==n&&this._bRequeryOnTextChange||r||this.searchBox.setAttribute("value",n),n!=this._lastQuery&&(this._bRequeryOnTextChange&&!this.suppressRequestForQuery?this.fetchSuggestions(n,t):this._bRequeryOnTextChange||(this._bRequeryOnTextChange=!0),this._lastQuery=n)),i=this._pollInterval,this._pollThrottlingEnabled&&(i*=1<<Math.max(0,this._pendingRequestCount-f+1)/2));sb_st(function(){return u.pollForQueryChange()},i)},o.prototype.fetchSuggestions=function(n,t){if(n.length<this._minChars){this.hideDropDown();return}this._noResultsTimeout&&sb_ct(this._noResultsTimeout);this.autosuggest.setCursorPosition(this.adjustCursorPositionForModifiedQuery(t,n));this.autosuggest.setQuery(n);this._pendingRequestCount++},o.prototype.adjustCursorPositionForModifiedQuery=function(n,t){var r=this.getCursorPosition(),i;if(t!==n&&t!="")for(i=0;i<n.length&&n[i]!=t[0];i++)r--;return r},o.prototype.handleResponseReceived=function(){this._pendingRequestCount--},o.prototype.getQueryToFetch=function(){var t=this.getCurrentQuery();return this.config.trimwsnr&&(t=n.Utils.TrimmedQueryFromSuggestions(this.autosuggest.canvas.currentSuggestionList,t)),t},o.prototype.isQueryGhosted=function(){return!!this._autoCompletedPrefixLength},o.prototype.getCurrentQuery=function(n){var t=this._autoCompletedPrefixLength?this.searchBox.value.substr(0,this._autoCompletedPrefixLength):this.searchBox.value;return n?t:t.replace(this._trimRegex,"").replace(this._removeSpacesRegex," ").toLowerCase()},o.prototype.addExtraQueryStrings=function(n){return n},o.prototype.getLastRequestedQuery=function(){return this._lastQuery},o.prototype.dispose=function(){this.clearEvents();this.bindEvents(sj_ue,sj_evt.unbind);sb_ct(this._noResultsTimeout)},o.ScopeExtensions=[],o}(n.EventRegisterer);n.SearchForm=e})(t=n.AS||(n.AS={}))}(Bing||(Bing={})),function(n){var t;(function(n){var t=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,i=function(){function i(){this._imeInProgress=!1}return i.prototype.init=function(t){if(t.config.eHC){var i=new n.EventRegistration(this);i.add(6,this.onSearchFormInitialized);t.registerEvents(i)}},i.prototype.onSearchFormInitialized=function(i){var r=this,u=i.autosuggest,e;u.ghostInstValue=0;var c=function(){return u.ghostInstValue=2},l=function(){u.ghostInstValue==0&&(u.ghostInstValue=1)},f=i.searchBox,s=function(t,i){return n.Utils.SetSelectionRange(f,t,i)};this.isCursorPositionAtTheEnd=function(){return i.getCursorPosition()==r.getPartialQuery().length};this.getSearchBoxValue=function(){return f.value};this.getPartialQuery=function(){return i.getCurrentQuery(!0)};this.getGhostedQuery=function(){return i.isQueryGhosted()?r.getSearchBoxValue():null};this.resetGhosting=function(n,t,i){if(u.raiseUpdateGhostedText(null,null,n),t){var f=r.getSearchBoxValue().length;s(f,f)}i&&c()};this.removeGhosting=function(n){n?u.raiseUpdateTextAndRequery(r.getPartialQuery()):u.raiseUpdateText(r.getPartialQuery())};this.setGhostValue=function(n,t){t?(u.raiseUpdateGhostedText(n,t),s(n.length,(n+t).length),l()):u.raiseUpdateTextAndRequery(n)};var a=function(n){return r.handleSearchBoxKeyPress(n)},v=function(n){return r.handleSearchBoxKeyDown(n)},y=function(){return r.handleSearchBoxMouseDown()},p=function(){return r.removeGhosting(!1)},w=function(){return r.handleCompositionStart()},b=function(){return function(){return r.handleCompositionEnd()}},k=function(n){return r.handleSearchBoxKeyUp(n)},h=function(n,i){n(f,"keypress",a);n(f,"keydown",v);n(f,"mousedown",y);i("onFeedbackStarting",p);t?(n(f,"compositionstart",w),n(f,"compositionend",b)):n(f,"keyup",k)},o=new n.EventRegistration(this);o.add(10,this.handleSuggestionsRendered);o.add(17,function(){return h(sj_ue,sj_evt.unbind)});u.registerEvents(o);e=new n.EventRegistration(this);e.add(15,function(){r.getGhostedQuery()&&r.resetGhosting(!1,!0,!0)});e.add(16,function(){r.getGhostedQuery()&&r.removeGhosting(!1)});i.registerEvents(e);h(sj_be,sj_evt.bind)},i.prototype.handleCompositionStart=function(){this._imeInProgress=!0},i.prototype.handleCompositionEnd=function(){this._imeInProgress&&(this._imeInProgress=!1,this.resetGhosting(!0,!1,!1),this._pendingGhostFirstSuggestion&&sb_st(this._pendingGhostFirstSuggestion,0))},i.prototype.ghostFirstSuggestion=function(n,t,i){var r,u,f;if((this._pendingGhostFirstSuggestion=null,n&&t==n.toLowerCase())&&this._lastKeyDown!=46&&this._lastKeyDown!=8&&this.isCursorPositionAtTheEnd()){for(u=0;u<i.length;++u)if(i[u].hc){r=i[u].query;break}r&&r.indexOf(t)==0&&r.length>n.length?(f=r.slice(n.length),this.setGhostValue(n,f)):this.getGhostedQuery()&&this.removeGhosting(!0)}},i.prototype.handleSuggestionsRendered=function(n,t){var r=this,i=this.getPartialQuery();this._imeInProgress?this._pendingGhostFirstSuggestion=function(){return r.ghostFirstSuggestion(i,n,t)}:this.ghostFirstSuggestion(i,n,t)},i.prototype.handleSearchBoxKeyDown=function(n){var r=this,i=this._lastKeyDown=n.keyCode,u;if(n.ctrlKey&&i==90){sj_pd(n);return}(t||this._imeInProgress||i!=229||this.handleCompositionStart(),!this._imeInProgress&&this.getGhostedQuery()&&i!=38&&i!=40)&&(i==13?this.resetGhosting(!1,!0,!0):i==37||i==33||n.shiftKey&&i==39?this.resetGhosting(!1,!1,!0):i==35||i==34||i==39||n.ctrlKey&&i==65?this.resetGhosting(!0,!1,!0):i==9?(this.resetGhosting(!0,!0,!0),sj_pd(n)):i==27||n.ctrlKey&&i==8?(this.removeGhosting(!0),sj_pd(n)):i==46||i==8||n.ctrlKey&&i==88?this.resetGhosting(!1,!1,!1):n.ctrlKey&&i==86||n.shiftKey&&i==45?this.removeGhosting(!0):(u=this.getSearchBoxValue().toLowerCase(),sb_st(function(){u!=r.getSearchBoxValue().toLowerCase()&&r.resetGhosting(!0,!1,!1)},0)))},i.prototype.handleSearchBoxKeyUp=function(n){var t=n.keyCode;this._imeInProgress&&(t==13||t==27||t==8||t==37||t==39)&&this.handleCompositionEnd()},i.prototype.handleSearchBoxKeyPress=function(n){var t=this.getGhostedQuery();if(t){var i=n.char?n.char:String.fromCharCode(n.charCode?n.charCode:n.keyCode),r=this.getPartialQuery(),u=t.slice(r.length);u.charAt(0)==i.toLowerCase()&&(this.setGhostValue(r+i,u.slice(1)),sj_pd(n))}},i.prototype.handleSearchBoxMouseDown=function(){this.getGhostedQuery()&&this.resetGhosting(!1,!1,!0)},i}();n.SearchForm.ScopeExtensions.push(new i)})(t=n.AS||(n.AS={}))}(Bing||(Bing={}));sa_inst=new Bing.AS.SearchForm(sa_config);sa_inst.init("sa_inst");sa_eL&&sa_inst.show();_w.sj_evt&&sj_evt.fire("autoSugLoaded")